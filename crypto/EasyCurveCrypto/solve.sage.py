

# This file was *autogenerated* from the file solve.sage
from sage.all_cmdline import *   # import sage library

_sage_const_487320905246514996710882345135044871121512008237324170012832956924099792187540111460289912841726146244052980994686224403733605604797574545446413363085 = Integer(487320905246514996710882345135044871121512008237324170012832956924099792187540111460289912841726146244052980994686224403733605604797574545446413363085); _sage_const_1226837805973980837527822038751322812365918337743740867865572278640254983537702985917434056395578799418328688965000006513157019132052408854706352039810 = Integer(1226837805973980837527822038751322812365918337743740867865572278640254983537702985917434056395578799418328688965000006513157019132052408854706352039810); _sage_const_1 = Integer(1); _sage_const_0 = Integer(0); _sage_const_1372080776377718132103580573250223575813563729090936999426778086693588513088976978436348386875498733256960009237843675811430600305388144802989181423070 = Integer(1372080776377718132103580573250223575813563729090936999426778086693588513088976978436348386875498733256960009237843675811430600305388144802989181423070); _sage_const_547539313304824346468016104211543548758390954042222580390577379575954748088186706546832760968012782250222822932766795878310674456147870885251541155129 = Integer(547539313304824346468016104211543548758390954042222580390577379575954748088186706546832760968012782250222822932766795878310674456147870885251541155129); _sage_const_891150102340757904253323224280187690215443182646114447345589520678504447038359547177123014086693784493499556623169950335070623909489328924914931079385 = Integer(891150102340757904253323224280187690215443182646114447345589520678504447038359547177123014086693784493499556623169950335070623909489328924914931079385); _sage_const_3222648157761763022765666627526081771965464654735271102975016411514968380582603473685327245591880615139230739580267468459750307042925863983751432626117 = Integer(3222648157761763022765666627526081771965464654735271102975016411514968380582603473685327245591880615139230739580267468459750307042925863983751432626117)
p = _sage_const_3222648157761763022765666627526081771965464654735271102975016411514968380582603473685327245591880615139230739580267468459750307042925863983751432626117 
F = Integers(p)

a =  _sage_const_487320905246514996710882345135044871121512008237324170012832956924099792187540111460289912841726146244052980994686224403733605604797574545446413363085 
b =  _sage_const_891150102340757904253323224280187690215443182646114447345589520678504447038359547177123014086693784493499556623169950335070623909489328924914931079385 
G =  (2104329886347020236988353035966018948895884440835873927220509828281578294905534908501819771688826148463264706747608174635897075544044151799369074522293L, _sage_const_547539313304824346468016104211543548758390954042222580390577379575954748088186706546832760968012782250222822932766795878310674456147870885251541155129 )
H =  (_sage_const_1372080776377718132103580573250223575813563729090936999426778086693588513088976978436348386875498733256960009237843675811430600305388144802989181423070 , _sage_const_1226837805973980837527822038751322812365918337743740867865572278640254983537702985917434056395578799418328688965000006513157019132052408854706352039810 )

a = F(a)
b = F(b)
G = [F(G[_sage_const_0 ]), F(G[_sage_const_1 ])]
H = [F(H[_sage_const_0 ]), F(H[_sage_const_1 ])]
# original 'curve' : (y+a)^2 = x(x+b)^2

#translating to y^2=x^2*(x-b)

G[_sage_const_0 ] += b
G[_sage_const_1 ] += a
H[_sage_const_0 ] += b
H[_sage_const_1 ] += a

# magic transform

k = (-b).sqrt()
g = (G[_sage_const_1 ] + k*G[_sage_const_0 ])/(G[_sage_const_1 ] - k*G[_sage_const_0 ])
h = (H[_sage_const_1 ] + k*H[_sage_const_0 ])/(H[_sage_const_1 ] - k*H[_sage_const_0 ])
print discrete_log(h,g).hex().decode('hex')

